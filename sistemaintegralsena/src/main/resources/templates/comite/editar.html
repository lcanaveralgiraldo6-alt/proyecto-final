<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Editar Comité</title>
    <link rel="stylesheet" th:href="@{/css/estilos.css}">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
</head>
<body>
    <div th:replace="~{dashboard :: sidebar}"></div>
    <div class="main-content">
        <header th:replace="~{dashboard :: header-top}"></header>

        <div class="dashboard-area">
            <div class="form-container" style="margin:0 auto; max-width: 950px;">
                <h2>Editar Comité</h2>

                <div style="background: #f1f8ff; padding: 20px; border-radius: 8px; margin-bottom: 25px; border-left: 5px solid #0077c9;">
                    <h4 style="color:#0077c9; margin-top:0; border-bottom: 1px solid #dae0e5; padding-bottom: 10px;">Datos del Aprendiz y Ficha</h4>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; font-size: 0.9em; color: #333;">
                        <div>
                            <p><strong>Nombre:</strong> <span th:text="${aprendizEncontrado.nombreCompleto}"></span></p>
                            <p><strong>Tipo Doc:</strong> <span th:text="${aprendizEncontrado.tipoDocumento}"></span></p>
                            <p><strong>Documento:</strong> <span th:text="${aprendizEncontrado.numeroDocumento}"></span></p>
                            <p><strong>Celular:</strong> <span th:text="${aprendizEncontrado.celular}"></span></p>
                        </div>
                        <div>
                            <p><strong>Ficha:</strong> <span th:text="${aprendizEncontrado.ficha?.codigo ?: 'No Asignada'}"></span></p>
                            <p><strong>Programa:</strong> <span th:text="${aprendizEncontrado.ficha?.programa ?: 'N/A'}"></span></p>
                            <p><strong>Jornada:</strong> <span th:text="${aprendizEncontrado.ficha?.jornada ?: 'N/A'}"></span></p>
                            <p><strong>Modalidad:</strong> <span th:text="${aprendizEncontrado.ficha?.modalidad ?: 'N/A'}"></span></p>
                        </div>
                        <div>
                            <p><strong>Correo:</strong> <span th:text="${aprendizEncontrado.correo}"></span></p>
                            <p><strong>Etapa:</strong> <span th:text="${aprendizEncontrado.etapaFormacion}"></span></p>
                            <p><strong>Coordinación:</strong> <span th:text="${aprendizEncontrado.ficha?.coordinacion ?: 'N/A'}"></span></p>
                        </div>
                    </div>
                </div>
                
                <div th:if="${error}" class="alert-error-global"><span th:text="${error}"></span></div>

                <form method="POST" th:action="@{/comite/actualizar}" th:object="${comite}" novalidate>
                    
                    <input type="hidden" th:field="*{id}">
                    <input type="hidden" name="aprendizId" th:value="${aprendizEncontrado.id}">

                    <h5 style="color:#666; margin-bottom:15px;">Detalles de la Citación</h5>
                    <div class="row" style="display:flex; gap:15px;">
                        <div class="form-group" style="flex:1;">
                            <label>Fecha del Comité:</label>
                            <input type="date" th:field="*{fecha}" class="form-control">
                            <span th:errors="*{fecha}" class="error-message"></span>
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label>Hora:</label>
                            <input type="time" th:field="*{hora}" class="form-control">
                            <span th:errors="*{hora}" class="error-message"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Lugar o Enlace de Conexión:</label>
                        <input type="text" th:field="*{enlace}" class="form-control">
                        <span th:errors="*{enlace}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label>Tipo de Falta:</label>
                        <select th:field="*{tipoFalta}" class="form-control">
                            <option value="">-- Seleccione --</option>
                            <option value="Académica">Académica</option>
                            <option value="Disciplinaria">Disciplinaria</option>
                            
                        </select>
                        <span th:errors="*{tipoFalta}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label>Motivo de Citación:</label>
                        <textarea th:field="*{motivo}" class="form-control"></textarea>
                        <span th:errors="*{motivo}" class="error-message"></span>
                    </div>

                    <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
                    <h5 style="color:#666; margin-bottom:15px;">Asistentes y Responsables</h5>

                    <div class="form-group">
                        <label>Profesional de Bienestar (Asistente):</label>
                        <select th:field="*{profesionalBienestar}" class="form-control">
                            <option value="">-- Seleccione Profesional --</option>
                            <option th:each="pro : ${listaProfesionales}" 
                                    th:value="${pro.nombre}" 
                                    th:text="${pro.nombre} + ' (' + ${pro.rol} + ')'"></option>
                        </select>
                        <span th:errors="*{profesionalBienestar}" class="error-message"></span>
                    </div>

                    <div class="row" style="display:flex; gap:15px;">
                        <div class="form-group" style="flex:1;">
                            <label>Representante de Aprendices:</label>
                            <input type="text" th:field="*{representanteAprendices}" class="form-control">
                            <span th:errors="*{representanteAprendices}" class="error-message"></span>
                        </div>
                        <div class="form-group" style="flex:1;">
                            <label>Profesional a Cargo del Plan:</label>
                            <input type="text" th:field="*{profesionalCargoPlan}" class="form-control">
                            <span th:errors="*{profesionalCargoPlan}" class="error-message"></span>
                        </div>
                    </div>

                    <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
                    <h5 style="color:#666; margin-bottom:15px;">Resultados y Compromisos</h5>

                    <div class="form-group">
                        <label>Recomendación a Subdirección:</label>
                        <textarea th:field="*{recomendacion}" class="form-control"></textarea>
                        <span th:errors="*{recomendacion}" class="error-message"></span>
                    </div>

                    <div class="form-group">
                        <label>Plan de Mejoramiento (Descripción):</label>
                        <textarea th:field="*{planMejoramiento}" class="form-control"></textarea>
                        <span th:errors="*{planMejoramiento}" class="error-message"></span>
                    </div>

                    <div class="row" style="display:flex; gap:15px;">
                        <div class="form-group" style="flex:1;">
                            <label>Fecha Plazo Cumplimiento:</label>
                            <input type="date" th:field="*{fechaPlazo}" class="form-control">
                            <span th:errors="*{fechaPlazo}" class="error-message"></span>
                        </div>
                        
                        <div class="form-group" style="flex:1;">
                            <label>¿Se entrega Paz y Salvo?</label>
                            <select th:field="*{pazSalvo}" class="form-control">
                                <option value="false">NO</option>
                                <option value="true">SÍ</option>
                            </select>
                            <span th:errors="*{pazSalvo}" class="error-message"></span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Observaciones:</label>
                        <textarea th:field="*{observaciones}" class="form-control"></textarea>
                        <span th:errors="*{observaciones}" class="error-message"></span>
                    </div>

                    <button type="submit" style="background-color: #f39c12;">Actualizar Comité</button>
                    <a th:href="@{/comite}" class="btn-cancel">Cancelar</a>
                </form>
            </div>
        </div>
    </div>
</body>
</html>